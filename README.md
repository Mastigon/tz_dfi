1. Есть таблица A с полями id, project, type, parent_id, extra, у которой есть foreign key A.parent_id to A.id.
 
Поле type может иметь 3 значения root/branch/leaf. leaf могут содержать в extra параметр color. 
Некоторые leaf имеют связь с branch по parent_id.
Некоторые branch имеют связь с root по parent_id.

Нужно составить SQL запрос без создания функций для получения следующих данных:
- project: идентификатор проекта;
- root_id: идентификатор корня;
- branch_count: количество связанных с корнем веток;
- leaf_colors: массив уникальных цветов листьев без null;

Запрос должен формировать результать только для проекта с id = 1.

Запрос нужно составлять с учетом, что таблица предполагается очень большого размера и будет содержать в себе миллионы строк и тысячи проектов. 
(Не нужно создавать эти миллионы строк, достаточно предполагать, что они есть)

Пример:
| id | project | type   | parent_id | extra 		        |
| 1  |     1   | root   | null      | null  		        |
| 2  |     1   | root   | null      | null  		        |
| 3  |     1   | root   | null      | null  		        |
| 4  |     1   | branch | 1	        | null   	          |
| 5	 |     1   | branch | 1	        | null              |
| 6	 |     1   | branch | 1	        | null              |
| 7  |     1   | branch | 2         | null              |
| 8	 |     1   | branch | null      | null              |
| 9  |     1   | leaf   | 4         | {"color":"green"} |
| 10 |     1   | leaf   | 4         | {"color":"green"} |
| 11 |     1   | leaf   | 4         | {"color":"yellow"}|
| 12 |     1   | leaf   | 5         | {}		            |
| 13 |     1   | leaf   | 5         | {"color":"green"} |
| 14 |     1   | leaf   | 5         | {"color":"red"}   |
| 15 |     1   | leaf   | 7         | {"color":"green"} |
| 16 |     1   | leaf   | 7         | null		          |
| 17 |     1   | leaf   | null      | {"color":"green"} |

Результат запроса
| project | root_id | branch_count | leaf_colors 		 |
|    1    | 1	    | 3		 | {"green","yellow", "red"} |
|    1    | 2	    | 1		 | {"green"}		             |
|    1    | 3	    | 0		 | {}			                   |

2. Написать простое REST веб приложение представляющее из себя таблицу в БД.
Данные хранятся в оперативной памяти.
Доступные колонки в таблице id, value.
Приложение должно содержать базовые роуты /select (просто возврат всего в таблице), /insert (по value), /delete (по id),
а так же роуты для работы с вложенными транзакциями, /begin, /commit, /rollback. 
Транзакции должны открываться независимо друг от друга, а так же иметь возможность быть вложенными (Условно могут быть открыты одновременно 2 транзакции или транзакция внутри транзакции).

